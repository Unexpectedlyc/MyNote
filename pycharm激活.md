#### 一. 参考链接

1. 原作者博客: https://zhile.io/
2. 插件代码仓库: https://gitee.com/ja-netfilter/ja-netfilter
3. 热佬网站: https://3.jetbra.in/ (里面有密钥，但我没用过，先放这里吧)
4. 使用教程参考: https://cloud.tencent.com/developer/article/2080402 (我主要参考的是这个)

#### 二. 原理

简单说是在 idea 的 jvm 配置上javaagent，执行某个 jar，然后对 idea 的授权流程做了一些 hook 操作。具体原理分析看这个文章就好：https://blog.csdn.net/yangfeng20/article/details/137565926

然后授权激活方式有两种吧，一种是通过激活码激活，另一种是通过授权服务器

#### 三. [通过授权服务器激活]步骤

##### 1. 下载 ja-netfilter

去插件代码仓库下载最直接： https://gitee.com/ja-netfilter/ja-netfilter

##### 2. 配置ja-netfilter

- 打开ja-netfilter\config中的url.conf，内容配置如下

```csharp
[URL]
PREFIX,https://account.jetbrains.com/lservice/rpc/validateKey.action
```

**C#**

- 打开ja-netfilter\config中的dns.conf，内容配置如下

```csharp
[DNS]
EQUAL,jetbrains.com;
EQUAL,dbeaver.com
```

**C#**

- 打开ja-netfilter\config中的power.conf，内容配置如下

```rust
[Args]

[Result]
EQUAL,120506319308405029943033101198259523557651500267734599270782782071425072541184605728867830395125412768750966448411447392137801711908001958831204692561738046570955709184538088569271703484602917023462976408329100293802371486063140115775311907530943821345005598057265747678100463689973450156515895355214983079672467769169324175533323801179755544364921063654340185317077965735659865485150734884110709760680757502730007505995422237875348017761382234951127263548660889969621730944377739766734765769747684457663965611896398862841334032542726392699785677440644859509166466497325071885386505404431787167239320957696896447925472784312642576835792921100239616617639216190447230487878404191838684279341834945197861631446454083984351911070798505031973496634229907567362853550735007045265430703581336189733180744888091740381912913980707537008943084904260746266383019688346709856215660232636334604552145129775009725685598798774376749830567219982166661918408832945395290223853748014160473876195098438959881711585152480525870219408398012002829112863175041709512032251930709608035158747101960447898838942705485214217426612863919268749874079707310181890737049603255938886865558759802593500502795018952114650332765839003032013708006750600413455628536259,65537,860106576952879101192782278876319243486072481962999610484027161162448933268423045647258145695082284265933019120714643752088997312766689988016808929265129401027490891810902278465065056686129972085119605237470899952751915070244375173428976413406363879128531449407795115913715863867259163957682164040613505040314747660800424242248055421184038777878268502955477482203711835548014501087778959157112423823275878824729132393281517778742463067583320091009916141454657614089600126948087954465055321987012989937065785013284988096504657892738536613208311013047138019418152103262155848541574327484510025594166239784429845180875774012229784878903603491426732347994359380330103328705981064044872334790365894924494923595382470094461546336020961505275530597716457288511366082299255537762891238136381924520749228412559219346777184174219999640906007205260040707839706131662149325151230558316068068139406816080119906833578907759960298749494098180107991752250725928647349597506532778539709852254478061194098069801549845163358315116260915270480057699929968468068015735162890213859113563672040630687357054902747438421559817252127187138838514773245413540030800888215961904267348727206110582505606182944023582459006406137831940959195566364811905585377246353->31872219281407242025505148642475109331663948030010491344733687844358944945421064967310388547820970408352359213697487269225694990179009814674781374751323403257628081559561462351695605167675284372388551941279783515209238245831229026662363729380633136520288327292047232179909791526492877475417113579821717193807584807644097527647305469671333646868883650312280989663788656507661713409911267085806708237966730821529702498972114194166091819277582149433578383639532136271637219758962252614390071122773223025154710411681628917523557526099053858210363406122853294409830276270946292893988830514538950951686480580886602618927728470029090747400687617046511462665469446846624685614084264191213318074804549715573780408305977947238915527798680393538207482620648181504876534152430149355791756374642327623133843473947861771150672096834149014464956451480803326284417202116346454345929350148770746553056995922154382822307758515805142704373984019252210715650875853634697920708113806880196144197384637328982263167395073688501517286678083973976140696077590122053014085412828620051470085033364773099146103525313018873319293728800442101520384088109603555959893639842091339193857485407672132882577840295039058621747654642202620767068924079813640067442975
EQUAL,8028659553836119901593655311677865290672387540027895708985570867455842278776015838142490556122515317003830575671206217290165955723210315889275621408086645995280770696135307020454887097794294273869941097888549275028604248332746117479367032100139091095818169444690976206636597409322539276252570779516636180497560345090851316373570301807158645002654208816162902430571101092599540795501152368695431168224953320283502815852695423193526255836776240019085157444254721864134058745605280085897450952937893645487302683006269553010996013513395044612932182772364336368242146044741660443063207438830622376694839772096688572619877,65537,21052260334349247097390263197515551021430500095747078612475171670547647379514624742422155617118382403386162585789957995106937640909858927441120214136124618650916253946431099279059999234690271861285094667690686174087562943995337813383652323725628494261414287817117703355799303086256914782640807165021059760198249458510362432176960683009890989990086614909076853502936665842869163947730574085863127445475967466399017447434906719734480523659879746056728772390182338236187070557277461449143752467418310063647027554915213099799725713708651142505590086828211040619445941301844994775362846837122335522584661592447560060751169->986236757547332986472011617696226561292849812918563355472727826767720188564083584387121625107510786855734801053524719833194566624465665316622563244215340671405971599343902468620306327831715457360719532421388780770165778156818229863337344187575566725786793391480600129482653072861971002459947277805295727097226389568776499707662505334062639449916265137796823793276300221537201727072401742985542559596685092673521228140822200236743113743661549252453726123450722876929538747702356573783116197523966334991563351853851212597377279504828784687920949198341066450537230593608440475006386024448307924665012521692416658191
```

**Rust**

- 配置 IDEA 的启动 VM 参数

这里有两种方式：
一是打开 idea，“帮助”-“编辑自定义虚拟机选项”，打开配置文件
二是配置环境变量 IDEA_VM_OPTIONS，值是配置文件的路径（比较建议这种，因为可以将配置文件和ja-netfilter放一起）

配置文件内容如下（主要是后三行，其它不加也可以，第三行注意路径）：

```diff
-Xms128m
-Xmx8192m
-Dfile.encoding=UTF-8
-XX:ReservedCodeCacheSize=512m
-XX:+IgnoreUnrecognizedVMOptions
-XX:+UseG1GC
-XX:SoftRefLRUPolicyMSPerMB=50
-XX:CICompilerCount=2
-XX:+HeapDumpOnOutOfMemoryError
-XX:-OmitStackTraceInFastThrow
-ea
-Dsun.io.useCanonCaches=false
-Djdk.http.auth.tunneling.disabledSchemes=""
-Djdk.attach.allowAttachSelf=true
-Djdk.module.illegalAccess.silent=true
-Dkotlinx.coroutines.debug=off
-XX:ErrorFile=$USER_HOME/java_error_in_idea_%p.log
-XX:HeapDumpPath=$USER_HOME/java_error_in_idea.hprof

--add-opens=java.base/jdk.internal.org.objectweb.asm=ALL-UNNAMED
--add-opens=java.base/jdk.internal.org.objectweb.asm.tree=ALL-UNNAMED
-javaagent:E:\ja-netfilter\ja-netfilter.jar
```

**Diff**

- 重启 IDEA，进行授权校验
  选择“许可证服务器”方式，输入：

```bash
https://jetbra.in
```

**Bash**

点激活即可

#### 四. [通过激活码激活]步骤 ##推荐##

##### 1. 下载 ja-netfilter

去插件代码仓库下载最直接： https://gitee.com/ja-netfilter/ja-netfilter

##### 2. 配置ja-netfilter

- 打开ja-netfilter\config中的url.conf，内容配置如下

```csharp
[URL]
PREFIX,https://account.jetbrains.com/lservice/rpc/validateKey.action
```

**C#**

- 打开ja-netfilter\config中的dns.conf，内容配置如下

```csharp
[DNS]
EQUAL,jetbrains.com
EQUAL,plugin.obroom.com
```

**C#**

- 打开ja-netfilter\config中的power.conf，内容配置如下

```rust
[Result]
; Suit 230914
EQUAL,75888623192465772084955377951198306702135327313062315225563718470653661793801719178647553532410237467495550800187973529202133466238825354135988657390766050197160093050945611087414688022502220060564716139142356429494315004946432334067127515081383336664162877126600357077796107641437507844835265792365885264118815924123978949395829736969354441202826225673948313261585644898954777409621857150971668073862687253868141869122469331021430401371289707681211947592819675200121184556360932201089199282211738120006888533563163642302207579745484728384486428222208213812291528007428530070242454238203928550683105421062331094750845145505608972009635176965215115688208740845303355991059521804735078574469432870400787428253602342729300042328170420659062588195293985517003844343989763104027328569042852690996233875190439074960872926324787157115483523118473430609411096400697894536993294915535905449630056538884982426205451557516203033628658808550799424730131437543420952769712793044255279152357141856290356977839447381244929084411487482957782888343837193520146442780899122074573307925429597225835206724304378622338028349953089952976438255759582568115277066791679931555627913314296216846420738487344812850701846117667234235837952975099539950423673283,65537,860106576952879101192782278876319243486072481962999610484027161162448933268423045647258145695082284265933019120714643752088997312766689988016808929265129401027490891810902278465065056686129972085119605237470899952751915070244375173428976413406363879128531449407795115913715863867259163957682164040613505040314747660800424242248055421184038777878268502955477482203711835548014501087778959157112423823275878824729132393281517778742463067583320091009916141454657614089600126948087954465055321987012989937065785013284988096504657892738536613208311013047138019418152103262155848541574327484510025594166239784429845180875774012229784878903603491426732347994359380330103328705981064044872334790365894924494923595382470094461546336020961505275530597716457288511366082299255537762891238136381924520749228412559219346777184174219999640906007205260040707839706131662149325151230558316068068139406816080119906833578907759960298749494098180107991752250725928647349597506532778539709852254478061194098069801549845163358315116260915270480057699929968468068015735162890213859113563672040630687357054902747438421559817252127187138838514773245413540030800888215961904267348727206110582505606182944023582459006406137831940959195566364811905585377246353->31872219281407242025505148642475109331663948030010491344733687844358944945421064967310388547820970408352359213697487269225694990179009814674781374751323403257628081559561462351695605167675284372388551941279783515209238245831229026662363729380633136520288327292047232179909791526492877475417113579821717193807584807644097527647305469671333646868883650312280989663788656507661713409911267085806708237966730821529702498972114194166091819277582149433578383639532136271637219758962252614390071122773223025154710411681628917523557526099053858210363406122853294409830276270946292893988830514538950951686480580886602618927728470029090747400687617046511462665469446846624685614084264191213318074804549715573780408305977947238915527798680393538207482620648181504876534152430149355791756374642327623133843473947861771150672096834149014464956451480803326284417202116346454345929350148770746553056995922154382822307758515805142704373984019252210715650875853634697920708113806880196144197384637328982263167395073688501517286678083973976140696077590122053014085412828620051470085033364773099146103525313018873319293728800442101520384088109603555959893639842091339193857485407672132882577840295039058621747654642202620767068924079813640067442975
EQUAL,4567779103874449240239662079205755693310005494862953689035396528991239683757589293624793159086473078120525402705628668311011890736316009197336637618610678228335893871114776326732074651573599517183986646340269857646364268233297330841971478101796167577290403903951299979151237090006996215332833149647379173998334898565513245453314930221017432024042566544774579402202436449192695033949441775713989000390069186056155554036916655795953904286792217740042538667425813361568996822385856479840230242261144865693876294228019553278637298651584820286962308928945030622629481823105481646878879253938847572671471342492590603058305,65537,24156627931985958051017183040835577271803742470193804806479316178045088981962804168393398987646446251087541768081971475544151551235525470790716604369379805327668466429966167642117961353233058515180243264560201783520956161510523416923017697354365782825500659342029196527776056976223174394946371372849906309277537461992299774200098515526818746947230488275456663264920440977381968978227273889068919338259949793686590492904029279861913225794809675826299753284990778166519152326723946780528965868736869495336993456735232755342913885746267768375682771655854436236934171901662660193080235109535758464079136573948168636773471->986236757547332986472011617696226561292849812918563355472727826767720188564083584387121625107510786855734801053524719833194566624465665316622563244215340671405971599343902468620306327831715457360719532421388780770165778156818229863337344187575566725786793391480600129482653072861971002459947277805295727097226389568776499707662505334062639449916265137796823793276300221537201727072401742985542559596685092673521228140822200236743113743661549252453726123450722876929538747702356573783116366629850199080495560991841329893037291900147497007197055572787780928474439121910577036698817920238800419515637284683828672110

[Args]
EQUAL,65537,24773058818499217187577663886010908531303294206336895556072197892590450942803807164562754911175164262596715237551312004078542654996496301487027034803410086499747369353221485073240039340641397198525027728751956658900801359887190562885573922317930300068615009483578963467556425525328780085523172495307229112069939166202511721671904748968934606589702999279663332403655662225374084460291376706916679151764149324177444374590606643838366605181996272409014933080082205048098737253668016260658830645459388519595314928290853199112791333551144805347785109465401055719331231478162870216035573012645710763533896540021550083104281->3,24773058818499217187577663886010908531303294206336895556072197892590450942803807164562754911175164262596715237551312004078542654996496301487027034803410086499747369353221485073240039340641397198525027728751956658900801359887190562885573922317930300068615009483578963467556425525328780085523172495307229112069939166202511721671904748968934606589702999279663332403655662225374084460291376706916679151764149324177444374590606643838366605181996272409014933080082205048098737253668016260658830645459388519595314928290853199112791333551144805347785109465401055719331231478162870216035573012645710763533896540021550083104281
```

**Rust**

- 配置 IDEA 的启动 VM 参数

这里有两种方式：
一是打开 idea，“帮助”-“编辑自定义虚拟机选项”，打开配置文件
二是配置环境变量 IDEA_VM_OPTIONS，值是配置文件的路径（比较建议这种，因为可以将配置文件和ja-netfilter放一起）

配置文件内容如下（主要是后三行，其它不加也可以，第三行注意路径）：

```diff
-Xms128m
-Xmx8192m
-Dfile.encoding=UTF-8
-XX:ReservedCodeCacheSize=512m
-XX:+IgnoreUnrecognizedVMOptions
-XX:+UseG1GC
-XX:SoftRefLRUPolicyMSPerMB=50
-XX:CICompilerCount=2
-XX:+HeapDumpOnOutOfMemoryError
-XX:-OmitStackTraceInFastThrow
-ea
-Dsun.io.useCanonCaches=false
-Djdk.http.auth.tunneling.disabledSchemes=""
-Djdk.attach.allowAttachSelf=true
-Djdk.module.illegalAccess.silent=true
-Dkotlinx.coroutines.debug=off
-XX:ErrorFile=$USER_HOME/java_error_in_idea_%p.log
-XX:HeapDumpPath=$USER_HOME/java_error_in_idea.hprof

--add-opens=java.base/jdk.internal.org.objectweb.asm=ALL-UNNAMED
--add-opens=java.base/jdk.internal.org.objectweb.asm.tree=ALL-UNNAMED
-javaagent:E:\ja-netfilter\ja-netfilter.jar
```

**Diff**

- 访问 https://3.jetbra.in/ ，获取激活码，版本似乎差不多就得了，我2023.3版本的idea，用里面的2023.2的激活码也可以用
- 重启 IDEA，进行授权校验
  选择“激活码激活器”方式，输入上面获取的激活码，点激活即可

#### 后记

我试了通过“授权服务器”激活的方式，发现也能成功，但显示2024-05-26到期，不知道是不是真的会到期，懒得折腾。所以最后我选择了“激活码激活”的方式，目前显示的是2026-09-14到期，如果两年后我还在用，那到时候还去那个网站重新获取新的激活码就好了

#### 花絮

这边文章写于2024-05-24，但其实早在半年多以前我就搞过了，但没有详细了解，只是网上搜了好多教程，东拼西凑，最后跑通了。之前用的是“授权码激活”方式，然后今天发现还有2天都到期了，所以就提前来看看怎么弄，没想到捣鼓了一下，得，啥都不能用了。只得细细了解下整个流程，有几个坑来记录一下吧：

1. 虚拟机配置文件的目录，对于这个文件的路径，其实挺复杂的，具体可以看idea安装目录里面idea.bat文件，看懂里面的代码也就知道了。对普通的我们来说，不想管那么多，可以只知道，环境变量 `IDEA_VM_OPTIONS` 可以配上你自定义的虚拟机配置文件，你想放哪就放哪，没配这个的话就走系统默认的路径（好像也在idea安装目录下，可以在idea.bat内打echo就知道了）
2. 我捣鼓了那么久都不成功问题，一开始我以为是激活码问题或者网络问题，后面发现其实是ja-netfilter没有被执行到，应该是我下载的jar有问题，后面重新去仓库下载就正常了。要怎么知道ja-netfilter有没有正常执行呢。
   关掉idea，去idea的安装目录，把idea.bat文件拖动到“命令提示符”执行，就好，如果有出现类似于下面的文字，就说明执行成功了，反之则没执行成功

```markdown
  ============================================================================

    ja-netfilter 2022.2.0

    A javaagent framework :)

    https://github.com/ja-netfilter/ja-netfilter

  ============================================================================
```